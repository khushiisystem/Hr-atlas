<ion-header [translucent]="true" mode="md">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button mode="md" [routerDirection]="'back'" [routerLink]="['/tabs/home']" routerLinkActive="router-link-active" type="button" fill="clear" [ariaDisabled]="true" class="noRipple noBg">
        <ion-icon name="chevron-back-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Assign Project</ion-title>
    <ion-thumbnail slot="end" class="logo_img ion-margin-end">
      <ion-img src="../../../assets/icon/hr-atlas_logo_2.png" alt="HR-Atlas"></ion-img>
    </ion-thumbnail>
    <!-- <ion-progress-bar type="indeterminate" *ngIf="!isDataLoaded"></ion-progress-bar> -->    
    <ion-progress-bar type="indeterminate" *ngIf="!isDataLoaded"></ion-progress-bar>         
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <form [formGroup]="assignProjectForm" class="ion-padding">
    
    
    <ion-row>
      <ion-col size="12">
        <ion-select formControlName="projectId" label="Projects" interface="popover" label-placement="floating" mode="md" fill="solid">
          <div *ngFor="let project of projects; index as i">
            <ion-select-option value="{{project.guid}}">{{project.title}}</ion-select-option>
          </div>
        </ion-select>          
      </ion-col>
      <ion-col size="12">
        <ion-select formControlName="userId" label="Employees List" interface="popover" label-placement="floating" fill="solid" mode="md" [multiple]="false">
          <ion-select-option *ngFor="let emp of allEmployeeList; index as i" value="{{emp.guid}}">{{ emp.firstName }} {{ emp.lastName }}</ion-select-option>
        </ion-select>
      </ion-col>
      <ion-col size="6" id="startdate">
        <ion-input labelPlacement="floating" [color]="'medium'" fill="solid" [value]="getDate('startDate') | date" [errorText]="assignProjectForm.controls['startDate'].touched && assignProjectForm.controls['startDate'].errors ? 'Start date is required' : ''" [required]="true" class="dateInput">
          <div slot="label">Start Data <ion-text color="danger">*</ion-text></div>
        </ion-input>
      </ion-col>
      <ion-modal trigger="startdate" [initialBreakpoint]="0.75" mode="ios" [keepContentsMounted]="true" [breakpoints]="[0.75, 1]" #startDateModal>
        <ng-template>
          <ion-header>
            <ion-toolbar>
              <ion-title>Select Date</ion-title>
            </ion-toolbar>
          </ion-header>
          <ion-content>
            <ion-datetime presentation="date" formControlName="startDate" mode="md" [size]="'cover'" [preferWheel]="false" #datetime (ionChange)="selectDate($any($event))">
              <!-- <span slot="title">Select {{selectedCtrl}} Date</span> -->
              <ion-buttons slot="buttons">
                <ion-button mode="ios" color="danger" (click)="datetime.cancel(); startDateModal.dismiss();">Cancel</ion-button>
                <ion-button mode="ios" color="primary" (click)="datetime.confirm(); startDateModal.dismiss()">Done</ion-button>
              </ion-buttons>
            </ion-datetime>
          </ion-content>
        </ng-template>
      </ion-modal>

      <ion-col size="6" id="endDate">
        <ion-input labelPlacement="floating" [color]="'medium'" fill="solid" [value]="getEndDate('endDate') | date" [errorText]="assignProjectForm.controls['endDate'].touched && assignProjectForm.controls['endDate'].errors ? 'End date is required' : ''" [required]="true" class="dateInput">
          <div slot="label">End Data <ion-text color="danger">*</ion-text></div>
        </ion-input>
      </ion-col>
      <ion-modal trigger="endDate" [initialBreakpoint]="0.75" mode="ios" [keepContentsMounted]="true" [breakpoints]="[0.75, 1]" #endDateModal>
        <ng-template>
          <ion-header>
            <ion-toolbar>
              <ion-title>Select Date</ion-title>
            </ion-toolbar>
          </ion-header>
          <ion-content>
            <ion-datetime presentation="date" formControlName="endDate" mode="md" [size]="'cover'" [preferWheel]="false" #datetime (ionChange)="selectEndDate($any($event))">
              <!-- <span slot="title">Select {{selectedCtrl}} Date</span> -->
              <ion-buttons slot="buttons">
                <ion-button mode="ios" color="danger" (click)="datetime.cancel();endDateModal.dismiss();">Cancel</ion-button>
                <ion-button mode="ios" color="primary" (click)="datetime.confirm();endDateModal.dismiss()">Done</ion-button>
              </ion-buttons>
            </ion-datetime>
          </ion-content>
        </ng-template>
      </ion-modal>
    </ion-row>
  </form>

  <ion-button mode="md" type="submit" class="submitBtn" [disabled]="assignProjectForm.invalid || isInProgress" (click)="submit()"  color="primary" expand="full" shape="round">{{updateForm ? 'Update' : 'Submit'}}</ion-button>

  <ion-card class="ion-margin" *ngFor="let assProject of assProjects; index as i">
    <div class="wrapper">
      <div class="ion-activatable rounded-rectangle">
        <h5>{{assProject.project.title}}</h5>
        <!-- update  -->
        <ion-button size="small" (click)="update(assProject)"><ion-icon name="create-outline"></ion-icon></ion-button>
     </div> 
      <div class="date">
        <p><span>Employeee : {{assProject.user.firstName}} {{assProject.user.lastName}}</span> <span></span></p>
        <p><span>Start Date :</span> <span>{{assProject.startDate | date: 'dd-MMMM-yyyy'}}</span></p>
         <p><span>End Date :</span> <span>{{assProject.endDate| date: 'dd-MMMM-yyyy'}}</span></p>
      </div>       
    </div>
  </ion-card>
</ion-content>