<ion-header [translucent]="true" mode="md">
    <ion-toolbar>
      <ion-buttons slot="start">
        <ion-button mode="md" [routerDirection]="'back'" (click)="goBack()" fill="clear" [ariaDisabled]="true" class="noRipple noBg">
          <ion-icon name="chevron-back-outline" slot="icon-only"></ion-icon>
        </ion-button>
      </ion-buttons>
      <ion-title>Employee List</ion-title>
      <ion-progress-bar type="indeterminate" *ngIf="!isDataLoaded"></ion-progress-bar>
    </ion-toolbar>
  </ion-header>
  
  <ion-content [fullscreen]="true">
    <ion-refresher slot="fixed" (ionRefresh)="handleRefresh($event)">
      <ion-refresher-content></ion-refresher-content>
    </ion-refresher>
    <div class="container ion-padding-top"  *ngIf="userRole === 'Admin'">
      <ion-row class="ion-padding-horizontal">
        <ion-col size="12">
          <ion-input placeholder="Search" [clearOnEdit]="true" [clearInput]="true" fill="outline" shape="round" [(ngModel)]="searchString" (ionInput)="onSearch()"></ion-input>
        </ion-col>
      </ion-row>
  
      <ion-list *ngIf="isDataLoaded">
        <ion-item lines="none" [button]="false" *ngIf="employeeList.length === 0">
          <ion-label class="ion-text-center">No any employee.</ion-label>
        </ion-item>
  
        <ion-item-sliding #editSlide [disabled]="lastRoute === '/tabs/settings'" *ngFor="let employee of employeeList; index as i;">
          <ion-item-options side="start">
            <ion-item-option color="primary" aria-label="Edit" type="button" (click)="employeeMoal(employee.guid, 'edit'); editSlide.closeOpened();">
              <ion-icon name="create-outline" aria-hidden="true" slot="icon-only" size="large"></ion-icon>
            </ion-item-option>
          </ion-item-options>
  
          <ion-item lines="full" [button]="true" [detail]="true" class="list-item" (click)="viewProfile(employee.guid)">
            <div slot="start" class="check_container">
              <ion-avatar class="employee_img">
                <app-name-img [name]="getName(employee)" [classes]="'sm'" *ngIf="employee.imageUrl.trim() === ''"></app-name-img>
                <img alt="imployee" *ngIf="employee.imageUrl.trim() != ''" [src]="employee.imageUrl || 'https://ionicframework.com/docs/img/demos/avatar.svg'" />
              </ion-avatar>
            </div>
            <div class="employee_data">
              <ion-label>{{employee.firstName | titlecase}} {{employee.lastName || '' | titlecase}}</ion-label>
              <ion-text class="role" *ngIf="employee.employeeWorkDetails"><small>{{employee.employeeWorkDetails.jobTitle | titlecase}}</small></ion-text>
            </div>
          </ion-item>
      
          <ion-item-options side="end">
            <ion-item-option color="danger" aria-label="Delete" (click)="deleteEmployee(employee.guid); editSlide.closeOpened();">
              <ion-icon name="trash-outline" aria-hidden="true" slot="icon-only" size="large"></ion-icon>
            </ion-item-option>
          </ion-item-options>
        </ion-item-sliding>
      </ion-list>
    </div>
    
    <div class="container" *ngIf="userRole === 'Employee' ">
      <ion-list *ngIf="isDataLoaded">
        <ion-item lines="none" [button]="false" *ngIf="employeeList.length === 0">
          <ion-label class="ion-text-center">No any employee.</ion-label>
        </ion-item>
  
        <ng-container *ngFor="let employee of employeeList; index as i;">
          <ion-item lines="full" [button]="true" [detail]="true" class="list-item" (click)="viewProfile(employee.guid)" *ngIf="employee.guid !== userId">
              <div slot="start" class="check_container">
                <ion-avatar class="employee_img">
                  <app-name-img [name]="getName(employee)" [classes]="'sm'" *ngIf="employee.imageUrl.trim() === ''"></app-name-img>
                  <img [alt]="getName(employee)" *ngIf="employee.imageUrl.trim() !== ''" [src]="employee.imageUrl || 'https://ionicframework.com/docs/img/demos/avatar.svg'" />
                </ion-avatar>
              </div>
              <div class="employee_data">
                <ion-label>{{employee.firstName | titlecase}} {{employee.lastName || '' | titlecase}}</ion-label>
                <ion-text class="role" *ngIf="employee.employeeWorkDetails"><small>{{employee.employeeWorkDetails.jobTitle | titlecase}}</small></ion-text>
            </div>
          </ion-item>
        </ng-container>
      </ion-list>
    </div>
    
    
    <ion-infinite-scroll #infiniteScroll (ionInfinite)="isMoreData ? loadData($any($event)) : ''" [position]="'bottom'" *ngIf="isMoreData">
      <ion-infinite-scroll-content *ngIf="isMoreData" loadingSpinner="bubbles" loadingText="Loading more data...">
      </ion-infinite-scroll-content>
    </ion-infinite-scroll>
  
    <ion-fab [vertical]="'bottom'" [horizontal]="'end'" [slot]="'fixed'" *ngIf="userRole === 'Admin' && lastRoute === '/tabs/home'">
      <ion-fab-button (click)="employeeMoal('', 'add')" aria-label="Add Employee">
        <ion-icon name="person-add-outline" aria-hidden="true"></ion-icon>
      </ion-fab-button>
    </ion-fab>
  </ion-content>
  <ion-footer *ngIf="userRole === 'Admin' && lastRoute === '/tabs/settings' && selectedEmployee.length > 0">
    <ion-button mode="md" type="button" color="primary" size="large" expand="block" shape="round" class="ion-margin-horizontal sendPayBtn">Send Payslip</ion-button>
  </ion-footer>
  